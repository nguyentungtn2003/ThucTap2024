<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Interface - Qu·∫£n l√Ω Nh√¢n Vi√™n</title>
  <link rel="stylesheet" href="../styles.css">
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
    }

    /* Top Header */
    .header {
      background-color: black;
      color: white;
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-top: 3px solid purple;
      border-bottom: 1px solid black;
    }

    /* Sidebar */
    .sidebar {
      width: 200px;
      background-color: white;
      padding-top: 20px;
      border-right: 1px solid lightgray;
      height: 100vh;
      position: fixed;
      top: 0;
      left: 0;
      margin-top: 45px; /* to align with the header */
    }

    .sidebar a {
      display: block;
      color: black;
      padding: 10px 15px;
      text-decoration: none;
      font-weight: bold;
    }

    .sidebar a:hover {
      background-color: #f0f0f0;
    }

    /* Main Content */
    .main-content {
      margin-left: 200px; /* Width of the sidebar */
      padding: 20px;
      height: calc(100vh - 45px); /* Adjust for header height */
    }

    /* Form Styles */
    .form-container {
      background-color: #f9f9f9;
      border: 1px solid #ddd;
      padding: 20px;
      border-radius: 5px;
      max-width: 500px;
      margin-bottom: 20px;
    }

    .form-container h2 {
      margin-top: 0;
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }

    .form-group input[type="text"],
    .form-group input[type="email"],
    .form-group input[type="password"],
    .form-group input[type="date"] {
      width: 100%;
      padding: 8px;
      box-sizing: border-box;
    }

    .form-group .radio-group {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    /* Table */
    .table-container {
      overflow-x: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    th, td {
      padding: 10px;
      text-align: left;
    }

    th {
      background-color: black;
      color: white;
      font-weight: bold;
    }

    /* Row colors */
    tr:nth-child(odd) {
      background-color: #d9a5a5; /* Red color for odd rows */
    }

    tr:nth-child(even) {
      background-color: #c3d0d9; /* Blue color for even rows */
    }

    /* Icons */
    .icon {
      margin: 0 5px;
      cursor: pointer;
    }

    .icon:hover {
      opacity: 0.7;
    }

    button {
      background-color: #333; /* M√†u n·ªÅn xanh l√° c√¢y */
      color: white; /* M√†u ch·ªØ tr·∫Øng */
      padding: 10px 20px; /* Kho·∫£ng c√°ch b√™n trong */
      font-size: 16px; /* K√≠ch th∆∞·ªõc ch·ªØ */
      border: none; /* X√≥a vi·ªÅn m·∫∑c ƒë·ªãnh */
      border-radius: 5px; /* Bo g√≥c */
      cursor: pointer; /* Thay ƒë·ªïi con tr·ªè chu·ªôt th√†nh h√¨nh b√†n tay */
      box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1); /* T·∫°o hi·ªáu ·ª©ng ƒë·ªï b√≥ng */
      transition: background-color 0.3s ease; /* Hi·ªáu ·ª©ng chuy·ªÉn m√†u khi hover */
    }

    button:hover {
      background-color: #336; /* ƒê·ªïi m√†u khi di chu·ªôt */
    }

    button:active {
      background-color: #336; /* ƒê·ªïi m√†u khi nh·∫•n v√†o */
      box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.1); /* Gi·∫£m ƒë·ªï b√≥ng khi nh·∫•n */
      transform: translateY(2px); /* T·∫°o hi·ªáu ·ª©ng nh·∫•n xu·ªëng */
    }

  </style>
</head>
<body>

<!-- Top Header -->
<div class="header">
  <div>ADMIN 2</div>
  <div><a href="../login.html" style="color: white; text-decoration: none;">ƒêƒÉng xu·∫•t</a></div>
</div>

<!-- Sidebar -->
<div class="sidebar">
  <a href="/admin/staff-management">QU·∫¢N L√ç NH√ÇN VI√äN</a>
  <a href="/admin/ad2_room_mana.html">QU·∫¢N L√ç PH√íNG CHI·∫æU</a>
  <a href="/admin/ad2_cus_mana.html">QU·∫¢N L√ç KH√ÅCH H√ÄNG</a>
  <a href="/admin/ad2_addcus.html">TH√äM M·ªöI KH√ÅCH H√ÄNG</a>
  <a href="/admin/ad2_ticket_mana.html">QU·∫¢N L√ç V√â</a>
  <a href="/admin/ad2_addtick.html">TH√äM V√â</a>
  <a href="/admin/ad2_mv_mana.html">QU·∫¢N L√ç PHIM</a>
  <a href="/admin/ad2_addmovie.html">TH√äM PHIM</a>
  <a href="/admin/admin2.html">TH√îNG TIN C√Å NH√ÇN</a>
</div>

<!-- Main Content Area -->
<div class="main-content">
  <h1>Qu·∫£n L√Ω Nh√¢n Vi√™n</h1>

  <!-- Form Th√™m Nh√¢n Vi√™n M·ªõi -->
  <div class="form-container">
    <h2>Th√™m Nh√¢n Vi√™n M·ªõi</h2>
    <form id="addStaffForm">
      <div class="form-group">
        <label>Email:</label>
        <input type="email" id="email" required>
      </div>
      <div class="form-group">
        <label>H·ªç T√™n:</label>
        <input type="text" id="fullName" required>
      </div>
      <div class="form-group">
        <label>M·∫≠t Kh·∫©u:</label>
        <input type="password" id="password" required>
      </div>
      <div class="form-group">
        <label>S·ªë ƒêi·ªán Tho·∫°i:</label>
        <input type="text" id="phoneNumber" required>
      </div>
      <div class="form-group">
        <label>ƒê·ªãa Ch·ªâ:</label>
        <input type="text" id="address" required>
      </div>
      <div class="form-group">
        <label>Ng√†y Sinh:</label>
        <input type="date" id="dob" required>
      </div>
      <div class="form-group">
        <label>Gi·ªõi T√≠nh:</label>
        <div class="radio-group">
          <label><input type="radio" name="sex" value="M" required> Nam</label>
          <label><input type="radio" name="sex" value="F"> N·ªØ</label>
        </div>
      </div>
      <div class="form-group">
        <label>Tr·∫°ng Th√°i:</label>
        <div class="radio-group">
          <label><input type="radio" name="status" value="Active" required> Active</label>
          <label><input type="radio" name="status" value="Inactive"> Inactive</label>
        </div>
      </div>
      <button type="button" onclick="addStaff()">Th√™m Nh√¢n Vi√™n</button>
    </form>
  </div>

  <!-- Danh s√°ch Nh√¢n Vi√™n -->
  <div class="table-container">
    <table id="staffTable">
      <thead>
      <tr>
        <th>ID</th>
        <th>Fullname</th>
        <th>Email</th>
        <th>Role</th>
        <th>Dob</th>
        <th>Phone</th>
        <th>Address</th>
        <th>Sex</th>
        <th>Status</th>
        <th>Qu·∫£n L√Ω</th>
      </tr>
      </thead>
      <tbody id="staffTableBody">
      <!-- D·ªØ li·ªáu nh√¢n vi√™n s·∫Ω ƒë∆∞·ª£c th√™m ·ªü ƒë√¢y b·∫±ng JavaScript -->
      </tbody>
    </table>
  </div>
</div>

<script>
  // H√†m th√™m nh√¢n vi√™n (ƒë√£ c·∫≠p nh·∫≠t ƒë·ªÉ l·∫•y d·ªØ li·ªáu t·ª´ radio button)
  function addStaff() {
    const email = document.getElementById("email").value;
    const fullName = document.getElementById("fullName").value;
    const password = document.getElementById("password").value;
    const phoneNumber = document.getElementById("phoneNumber").value;
    const address = document.getElementById("address").value;
    const dob = document.getElementById("dob").value;
    const sex = document.querySelector('input[name="sex"]:checked').value;
    const status = document.querySelector('input[name="status"]:checked').value;

    fetch('/admin/staff', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
      },
      body: new URLSearchParams({
        email, fullName, password, phoneNumber, address, dob, sex, status
      })
    })
            .then(response => response.text())
            .then(data => {
              alert(data);
              loadStaffList(); // T·∫£i l·∫°i danh s√°ch sau khi th√™m m·ªõi
              document.getElementById("addStaffForm").reset(); // X√≥a n·ªôi dung form
            });
  }

  // T·∫£i danh s√°ch nh√¢n vi√™n khi trang ƒë∆∞·ª£c t·∫£i
  document.addEventListener("DOMContentLoaded", loadStaffList);

  // H√†m t·∫£i danh s√°ch nh√¢n vi√™n
  function loadStaffList() {
    fetch('/admin/staff')
            .then(response => response.json())
            .then(data => {
              const staffTableBody = document.getElementById("staffTableBody");
              staffTableBody.innerHTML = ""; // X√≥a n·ªôi dung c≈©

              data.forEach(staff => {
                const row = document.createElement("tr");
                row.innerHTML = `
            <td>${staff.id}</td>
            <td>${staff.fullName}</td>
            <td>${staff.email}</td>
            <td>${staff.roles.map(role => role.roleName).join(", ")}</td>
            <td>${staff.dob}</td>
            <td>${staff.phoneNumber}</td>
            <td>${staff.address}</td>
            <td>${staff.sex === 'M' ? 'Nam' : 'N·ªØ'}</td>
            <td>${staff.status}</td>
            <td>
              <span class="icon" onclick="editStaff(${staff.id})">‚úèÔ∏è</span>
              <span class="icon" onclick="deleteStaff(${staff.id})">üóëÔ∏è</span>
            </td>
          `;
                staffTableBody.appendChild(row);
              });
            })
            .catch(error => console.error('Error loading staff list:', error));
  }

  // H√†m X√≥a Nh√¢n Vi√™n
  function deleteStaff(id) {
    if (!confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a nh√¢n vi√™n n√†y?")) return;

    fetch(`/admin/staff/${id}`, {
      method: 'DELETE'
    })
            .then(response => response.text())
            .then(data => {
              alert(data);
              loadStaffList(); // T·∫£i l·∫°i danh s√°ch sau khi x√≥a
            });
  }

  // H√†m S·ª≠a Nh√¢n Vi√™n - ƒê√¢y l√† h√†m c∆° b·∫£n; c·∫ßn th√™m giao di·ªán ƒë·ªÉ c·∫≠p nh·∫≠t th√¥ng tin
  function editStaff(id) {
    const fullName = prompt("Nh·∫≠p h·ªç t√™n m·ªõi:");
    const phoneNumber = prompt("Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i m·ªõi:");
    const address = prompt("Nh·∫≠p ƒë·ªãa ch·ªâ m·ªõi:");
    const dob = prompt("Nh·∫≠p ng√†y sinh m·ªõi (YYYY-MM-DD):");
    const sex = prompt("Nh·∫≠p gi·ªõi t√≠nh m·ªõi (M/F):");
    const status = prompt("Nh·∫≠p tr·∫°ng th√°i m·ªõi (Active/Inactive):");

    fetch(`/admin/staff/${id}`, {
      method: 'PUT',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
      },
      body: new URLSearchParams({
        fullName, phoneNumber, address, dob, sex, status
      })
    })
            .then(response => response.text())
            .then(data => {
              alert(data);
              loadStaffList(); // T·∫£i l·∫°i danh s√°ch sau khi c·∫≠p nh·∫≠t
            });
  }
</script>

</body>
</html>
