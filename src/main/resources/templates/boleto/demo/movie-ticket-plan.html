<!DOCTYPE html>
<html lang="en" xmlns:th = "https://www.thymeleaf.org/">



<!-- Mirrored from pixner.net/boleto/demo/movie-ticket-plan.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 21 Nov 2024 13:24:47 GMT -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <link rel="stylesheet" data-th-href="@{css/bootstrap.min.css}">
    <link rel="stylesheet" data-th-href="@{css/all.min.css}">
    <link rel="stylesheet" data-th-href="@{css/animate.css}">
    <link rel="stylesheet" data-th-href="@{css/flaticon.css}">
    <link rel="stylesheet" data-th-href="@{css/magnific-popup.css}">
    <link rel="stylesheet" data-th-href="@{css/odometer.css}">
    <link rel="stylesheet" data-th-href="@{css/owl.carousel.min.css}">
    <link rel="stylesheet" data-th-href="@{css/owl.theme.default.min.css}">
    <link rel="stylesheet" data-th-href="@{css/nice-select.css}">
    <link rel="stylesheet" data-th-href="@{css/jquery.animatedheadline.css}">
    <link rel="stylesheet" data-th-href="@{css/main.css}">

    <link rel="shortcut icon" data-th-href="@{images/favicon.png}" type="image/x-icon">

    <title>Boleto  - Online Ticket Booking Website HTML Template</title>


</head>

<body>
    <!-- ==========Preloader========== -->
    <div class="preloader">
        <div class="preloader-inner">
            <div class="preloader-icon">
                <span></span>
                <span></span>
            </div>
        </div>
    </div>
    <!-- ==========Preloader========== -->
    <!-- ==========Overlay========== -->
    <div class="overlay"></div>
    <a href="#0" class="scrollToTop">
        <i class="fas fa-angle-up"></i>
    </a>
    <!-- ==========Overlay========== -->

    <!-- ==========Header-Section========== -->
    <header class="header-section">
        <div class="container">
            <div class="header-wrapper">
                <div class="logo">
                    <a href="index.html">
                        <img src="assets/images/logo/logo.png" alt="logo">
                    </a>
                </div>
                <ul class="menu">
                    <li>
                        <a href="home">Home</a>
                    </li>
                    <li>
                        <a th:href="@{'/list-movies'}" >movies</a>
                    </li>
                    <li>
                        <a href="contact.html">contact</a>
                    </li>
                    <li class="header-button pr-0">
                        <a href="login">join us</a>
                    </li>
                </ul>
                <div class="header-bar d-lg-none">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </header>
    <!-- ==========Header-Section========== -->

    <!-- ==========Window-Warning-Section========== -->
    <section class="window-warning inActive">
        <div class="lay" onclick="this.parentElement.classList.add('inActive')"></div>
        <div class="warning-item">
            <h6 class="subtitle">Welcome! </h6>
            <h4 class="title">Select Your Seats</h4>
            <div class="thumb">
                <img th:src="@{images/movie/seat-plan.png}" alt="movie">
            </div>
            <a class="custom-button seatPlanButton">Seat Plans<i class="fas fa-angle-right"></i></a>
        </div>
    </section>
    <!-- ==========Window-Warning-Section========== -->

    <!-- ==========Banner-Section========== -->
    <section class="details-banner hero-area bg_img" data-th-background="@{images/banner/banner03.jpg}">
        <div class="container">
            <div class="details-banner-wrapper">
                <div class="details-banner-content">
<!--                    <h3 class="title" th:text="${movie.title}"></h3>-->
<!--                    <p th:text="${movie.shortDescription}"></p>-->
<!--                    <div class="tags">-->
<!--                        <a th:each="language : ${movie.language}" th:text="${language}">English</a>-->
<!--                        -->
<!--                    </div>-->
                    <h3 class="title" th:text="${movie.title}">Movie Title</h3>
                    <div class="tags">
<!--                             <p th:text="${movie.shortDescription}"></p>-->
                        <p>Actors: <span th:text="${movie.actor}"></span></p>
<!--                        <p>Release Date: <span th:text="${movie.releaseDate}"></span></p>-->
                        <p>Duration: <span th:text="${movie.runningTime}"></span> minutes</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- ==========Banner-Section========== -->

    <!-- ==========Book-Section========== -->
    <section class="book-section bg-one">
        <div class="container">
            <form class="ticket-search-form two">
                <div class="form-group">
                    <div class="thumb">
                        <img th:src="@{images/ticket/date.png}" alt="ticket">
                    </div>
                    <span class="type">Select Date</span>
                    <select class="select-bar" id="date-select" onchange="fetchShowtimes()" required>
                        <!-- Lặp qua danh sách ngày chiếu từ model -->
                        <option>Select Date</option>
                        <th:block th:each="date : ${availableDates}">
                            <option th:value="${date}" th:text="${date}"></option>
                        </th:block>
                    </select>
                </div>
            </form>
        </div>
    </section>
    <!-- ==========Book-Section========== -->

    <!-- ==========Movie-Section========== -->
    <div class="ticket-plan-section padding-bottom padding-top">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-9 mb-5 mb-lg-0">
                    <ul id="list-show-times" class="seat-plan-wrapper bg-five">
                        <li class="active">
                            <!-- ==========suất chiếu hiển thị ở đây========== -->
                            <div id="showtimes-container" class="movie-schedule">
                                <div class="item">
                                    <!--09:40-->
                                </div>
                            </div>
                            <!-- ==========suất chiếu hiển thị ở đây========== -->
                        </li>
                    </ul>
                    <ul id="list-room" class="seat-plan-wrapper bg-five">
                        <li  class="active">
                            <!-- ==========phòng chiếu hiển thị ở đây========== -->
                            <div id="rooms-container" class="movie-schedule">
                                <div class="item">
                                    <!--RoomA-->
                                </div>
                            </div>
                            <!-- ==========phòng chiếu hiển thị ở đây========== -->
                        </li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-6 col-sm-10">
                    <div class="widget-1 widget-banner">
                        <div class="widget-1-body">
                            <a href="#0">
                                <img th:src="@{images/sidebar/banner/banner03.jpg}" alt="banner">
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // function fetchRooms(startTime) {
        //     const dateSelect = document.getElementById('date-select');
        //     const selectedDate = dateSelect.value;
        //     const roomContainer = document.getElementById('rooms-container');
        //
        //     // Sử dụng movieId từ Thymeleaf
        //     const movieId = [[${movieId}]];
        //
        //     // Xóa nội dung cũ trong roomContainer
        //     roomContainer.innerHTML = '<div>Đang tải...</div>';
        //
        //     // Gọi API để lấy danh sách phòng chiếu
        //     fetch(`/api/rooms?movieId=${movieId}&startDate=${selectedDate}&startTime=${startTime}`)
        //         .then(response => {
        //             if (!response.ok) {
        //                 throw new Error('Không thể lấy phòng chiếu');
        //             }
        //             return response.json();
        //         })
        //         .then(rooms => {
        //             // Làm sạch container và hiển thị danh sách phòng chiếu
        //             roomContainer.innerHTML = '';
        //             rooms.forEach(room => {
        //                 const roomDiv = document.createElement('div');
        //                 roomDiv.className = 'item';
        //                 roomDiv.textContent = `${room.cinemaRoomNum}`; // Hiển thị tên phòng
        //                 roomContainer.appendChild(roomDiv);
        //             });
        //         })
        //         .catch(error => {
        //             console.error(error);
        //             roomContainer.innerHTML = '<div>Lỗi tải phòng chiếu</div>';
        //         });
        // }
        //
        // function fetchShowtimes() {
        //     const dateSelect = document.getElementById('date-select');
        //     const showtimesContainer = document.getElementById('showtimes-container');
        //     const selectedDate = dateSelect.value;
        //     // const movieId = ;
        //
        //
        //     // Xóa nội dung cũ trong showtimes-container
        //     showtimesContainer.innerHTML = '<div>Đang tải...</div>';
        //
        //     // Gọi API lấy giờ chiếu
        //     fetch(`/api/schedule/start-times?movieId=[[${movieId}]]&startDate=${selectedDate}`)
        //         .then(response => {
        //             if (!response.ok) {
        //                 throw new Error('Không thể lấy giờ chiếu');
        //             }
        //             return response.json();
        //         })
        //         .then(startTimes => {
        //             // Làm sạch container và thêm giờ chiếu mới
        //             showtimesContainer.innerHTML = '';
        //             startTimes.forEach(time => {
        //                 const timeDiv = document.createElement('div');
        //                 timeDiv.className = 'item';
        //                 timeDiv.textContent = time;
        //                 // Thêm sự kiện click để gọi fetchRooms
        //                 timeDiv.addEventListener('click', () => {
        //                     fetchRooms(time); // Gọi API lấy phòng chiếu khi chọn suất chiếu
        //                 });
        //                 showtimesContainer.appendChild(timeDiv);
        //             });
        //         })
        //         .catch(error => {
        //             console.error(error);
        //             showtimesContainer.innerHTML = '<div>Lỗi tải giờ chiếu</div>';
        //         });
        // }

        // let selectedDate = null;
        // let selectedTime = null;
        // let selectedRoom = null;
        //
        // function fetchRooms(startTime) {
        //     const dateSelect = document.getElementById('date-select');
        //     const selectedDate = dateSelect.value;
        //     const roomContainer = document.getElementById('rooms-container');
        //
        //     const movieId = [[${movieId}]];
        //
        //     roomContainer.innerHTML = '<div>Đang tải...</div>';
        //
        //     fetch(`/api/rooms?movieId=${movieId}&startDate=${selectedDate}&startTime=${startTime}`)
        //         .then(response => {
        //             if (!response.ok) {
        //                 throw new Error('Không thể lấy phòng chiếu');
        //             }
        //             return response.json();
        //         })
        //         .then(rooms => {
        //             roomContainer.innerHTML = '';
        //             rooms.forEach(room => {
        //                 const roomDiv = document.createElement('div');
        //                 roomDiv.className = 'item';
        //                 roomDiv.textContent = room.cinemaRoomNum; // Hiển thị tên phòng
        //                 roomDiv.dataset.roomId = room.id; // Lưu ID phòng vào thuộc tính dữ liệu
        //                 roomDiv.addEventListener('click', () => {
        //                     selectRoom(roomDiv, room.id); // Truyền ID phòng vào
        //                 });
        //                 roomContainer.appendChild(roomDiv);
        //             });
        //         })
        //         .catch(error => {
        //             console.error(error);
        //             roomContainer.innerHTML = '<div>Lỗi tải phòng chiếu</div>';
        //         });
        // }
        //
        // function fetchShowtimes() {
        //     const dateSelect = document.getElementById('date-select');
        //     const showtimesContainer = document.getElementById('showtimes-container');
        //     selectedDate = dateSelect.value; // Lưu ngày đã chọn
        //
        //     showtimesContainer.innerHTML = '<div>Đang tải...</div>';
        //
        //     const movieId = [[${movieId}]];
        //
        //     fetch(`/api/schedule/start-times?movieId=${movieId}&startDate=${selectedDate}`)
        //         .then(response => {
        //             if (!response.ok) {
        //                 throw new Error('Không thể lấy giờ chiếu');
        //             }
        //             return response.json();
        //         })
        //         .then(startTimes => {
        //             showtimesContainer.innerHTML = '';
        //             startTimes.forEach(time => {
        //                 const timeDiv = document.createElement('div');
        //                 timeDiv.className = 'item';
        //                 timeDiv.textContent = time;
        //                 timeDiv.addEventListener('click', () => {
        //                     selectTime(timeDiv, time); // Lưu giờ đã chọn
        //                     fetchRooms(time);
        //                 });
        //                 showtimesContainer.appendChild(timeDiv);
        //             });
        //         })
        //         .catch(error => {
        //             console.error(error);
        //             showtimesContainer.innerHTML = '<div>Lỗi tải giờ chiếu</div>';
        //         });
        // }
        //
        // function selectTime(element, time) {
        //     document.querySelectorAll('#showtimes-container .item').forEach(item => {
        //         item.classList.remove('selected');
        //     });
        //     element.classList.add('selected');
        //     selectedTime = time; // Lưu giờ đã chọn
        //
        //     // Kiểm tra nếu đủ dữ liệu
        //     checkSelectionComplete();
        // }
        //
        // function selectRoom(element, roomId) {
        //     document.querySelectorAll('#rooms-container .item').forEach(item => {
        //         item.classList.remove('selected');
        //     });
        //     element.classList.add('selected');
        //     selectedRoom = roomId; // Lưu ID phòng
        //     checkSelectionComplete();
        // }
        //
        //
        // function checkSelectionComplete() {
        //     if (selectedDate && selectedTime && selectedRoom) {
        //         openConfirmationWindow();
        //     }
        // }
        //
        // function openConfirmationWindow() {
        //     const warningWindow = document.querySelector('.window-warning');
        //     const subtitle = warningWindow.querySelector('.subtitle');
        //     const title = warningWindow.querySelector('.title');
        //
        //     // Cập nhật thông tin trong cửa sổ
        //     subtitle.textContent = "Bạn đã chọn:";
        //     title.textContent = `Ngày: ${selectedDate}, Giờ: ${selectedTime}, Phòng: ${selectedRoom}`;
        //
        //     // Hiển thị cửa sổ
        //     warningWindow.classList.remove('inActive');
        //
        //     // Xử lý nút Seat Plans
        //     const seatPlanButton = document.querySelector('.seatPlanButton');
        //     seatPlanButton.addEventListener('click', (event) => {
        //         event.preventDefault();
        //         saveSelectionAndRedirect();
        //     });
        // }
        //
        // function saveSelectionAndRedirect() {
        //     const movieId = [[${movieId}]];
        //
        //     fetch('/api/booking/save-selection', {
        //         method: 'POST',
        //         headers: {
        //             'Content-Type': 'application/json',
        //         },
        //         body: JSON.stringify({
        //             movieId,
        //             selectedDate,
        //             selectedTime,
        //             selectedRoom,
        //         }),
        //     })
        //         .then(response => {
        //             if (!response.ok) {
        //                 throw new Error('Không thể lưu dữ liệu');
        //             }
        //             return response.json();
        //         })
        //         .then(() => {
        //             // Chuyển hướng đến trang chọn ghế
        //             window.location.href = `/seat-selection?movieId=${movieId}&startDate=${selectedDate}&startTime=${selectedTime}&roomId=${selectedRoom}`;
        //         })
        //         .catch(error => {
        //             console.error('Lỗi khi lưu dữ liệu:', error);
        //         });
        // }

        let selectedDate = null;
        let selectedTime = null;
        let selectedRoom = null;

        function fetchRooms(startTime) {
            const dateSelect = document.getElementById('date-select');
            const selectedDate = dateSelect.value;
            const roomContainer = document.getElementById('rooms-container');

            const movieId = [[${movieId}]];

            roomContainer.innerHTML = '<div>Đang tải...</div>';

            // Gọi API để lấy danh sách phòng chiếu
            fetch(`/api/rooms?movieId=${movieId}&startDate=${selectedDate}&startTime=${startTime}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Không thể lấy phòng chiếu');
                    }
                    return response.json();
                })
                .then(rooms => {
                    roomContainer.innerHTML = '';
                    rooms.forEach(room => {
                        const roomDiv = document.createElement('div');
                        roomDiv.className = 'item';
                        roomDiv.textContent = room.cinemaRoomNum; // Hiển thị tên phòng
                        roomDiv.dataset.roomId = room.id; // Lưu ID phòng vào thuộc tính dữ liệu
                        roomDiv.addEventListener('click', () => {
                            selectRoom(roomDiv, room.id); // Truyền ID phòng vào
                        });
                        roomContainer.appendChild(roomDiv);
                    });
                })
                .catch(error => {
                    console.error(error);
                    roomContainer.innerHTML = '<div>Lỗi tải phòng chiếu</div>';
                });
        }

        function fetchShowtimes() {
            const dateSelect = document.getElementById('date-select');
            const showtimesContainer = document.getElementById('showtimes-container');
            selectedDate = dateSelect.value; // Lưu ngày đã chọn

            showtimesContainer.innerHTML = '<div>Đang tải...</div>';

            const movieId = [[${movieId}]];

            // Gọi API lấy giờ chiếu
            fetch(`/api/schedule/start-times?movieId=${movieId}&startDate=${selectedDate}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Không thể lấy giờ chiếu');
                    }
                    return response.json();
                })
                .then(startTimes => {
                    showtimesContainer.innerHTML = '';
                    startTimes.forEach(time => {
                        const timeDiv = document.createElement('div');
                        timeDiv.className = 'item';
                        timeDiv.textContent = time;
                        timeDiv.addEventListener('click', () => {
                            selectTime(timeDiv, time); // Lưu giờ đã chọn
                            fetchRooms(time);
                        });
                        showtimesContainer.appendChild(timeDiv);
                    });
                })
                .catch(error => {
                    console.error(error);
                    showtimesContainer.innerHTML = '<div>Lỗi tải giờ chiếu</div>';
                });
        }

        function selectTime(element, time) {
            document.querySelectorAll('#showtimes-container .item').forEach(item => {
                item.classList.remove('selected');
            });
            element.classList.add('selected');
            selectedTime = time; // Lưu giờ đã chọn

            checkSelectionComplete();
        }

        function selectRoom(element, roomId) {
            document.querySelectorAll('#rooms-container .item').forEach(item => {
                item.classList.remove('selected');
            });
            element.classList.add('selected');
            selectedRoom = roomId; // Lưu ID phòng

            checkSelectionComplete();
        }

        function checkSelectionComplete() {
            if (selectedDate && selectedTime && selectedRoom) {
                openConfirmationWindow();
            }
        }

        function openConfirmationWindow() {
            const warningWindow = document.querySelector('.window-warning');
            const subtitle = warningWindow.querySelector('.subtitle');
            const title = warningWindow.querySelector('.title');

            // Cập nhật thông tin trong cửa sổ
            subtitle.textContent = "Bạn đã chọn:";
            title.textContent = `Ngày: ${selectedDate}, Giờ: ${selectedTime}, Phòng: ${selectedRoom}`;

            // Hiển thị cửa sổ
            warningWindow.classList.remove('inActive');

            // Xử lý nút Seat Plans
            const seatPlanButton = document.querySelector('.seatPlanButton');
            seatPlanButton.addEventListener('click', (event) => {
                event.preventDefault();
                redirectToSeatSelection();
            });
        }

        function redirectToSeatSelection() {
            const movieId = [[${movieId}]];

            // Chuyển hướng trực tiếp đến SeatController
            window.location.href = `/seat-selection?movieId=${movieId}&startDate=${selectedDate}&startTime=${selectedTime}&roomId=${selectedRoom}`;
        }

    </script>

    </script>

    <!-- ==========Movie-Section========== -->

    <!-- ==========Newslater-Section========== -->
    <footer class="footer-section">
        <div class="newslater-section padding-bottom">
            <div class="container">
                <div class="newslater-container bg_img" data-th-background="@{images/newslater/newslater-bg01.jpg}">
                    <div class="newslater-wrapper">
                        <h5 class="cate">subscribe to Boleto </h5>
                        <h3 class="title">to get exclusive benifits</h3>
                        <form class="newslater-form">
                            <input type="text" placeholder="Your Email Address">
                            <button type="submit">subscribe</button>
                        </form>
                        <p>We respect your privacy, so we never share your info</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="footer-top">
                <div class="logo">
                    <a href="index-1.html">
                        <img th:src="@{images/footer/footer-logo.png}" alt="footer">
                    </a>
                </div>
                <ul class="social-icons">
                    <li>
                        <a href="#0">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                    </li>
                    <li>
                        <a href="#0" class="active">
                            <i class="fab fa-twitter"></i>
                        </a>
                    </li>
                    <li>
                        <a href="#0">
                            <i class="fab fa-pinterest-p"></i>
                        </a>
                    </li>
                    <li>
                        <a href="#0">
                            <i class="fab fa-google"></i>
                        </a>
                    </li>
                    <li>
                        <a href="#0">
                            <i class="fab fa-instagram"></i>
                        </a>
                    </li>
                </ul>
            </div>
            <div class="footer-bottom">
                <div class="footer-bottom-area">
                    <div class="left">
                        <p>Copyright © 2020.All Rights Reserved By <a href="#0">Boleto </a></p>
                    </div>
                    <ul class="links">
                        <li>
                            <a href="#0">About</a>
                        </li>
                        <li>
                            <a href="#0">Terms Of Use</a>
                        </li>
                        <li>
                            <a href="#0">Privacy Policy</a>
                        </li>
                        <li>
                            <a href="#0">FAQ</a>
                        </li>
                        <li>
                            <a href="#0">Feedback</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>
    <!-- ==========Newslater-Section========== -->


    <script th:src="@{/js/jquery-3.3.1.min.js}"></script>
    <script th:src="@{/js/modernizr-3.6.0.min.js}"></script>
    <script th:src="@{/js/plugins.js}"></script>
    <script th:src="@{/js/bootstrap.min.js}"></script>
    <script th:src="@{/js/isotope.pkgd.min.js}"></script>
    <script th:src="@{/js/magnific-popup.min.js}"></script>
    <script th:src="@{/js/owl.carousel.min.js}"></script>
    <script th:src="@{/js/wow.min.js}"></script>
    <script th:src="@{/js/countdown.min.js}"></script>
    <script th:src="@{/js/odometer.min.js}"></script>
    <script th:src="@{/js/viewport.jquery.js}"></script>
    <script th:src="@{/js/nice-select.js}"></script>
    <script th:src="@{/js/main.js}"></script>
</body>


<!-- Mirrored from pixner.net/boleto/demo/movie-ticket-plan.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 21 Nov 2024 13:24:49 GMT -->
</html>